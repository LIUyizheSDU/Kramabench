[
    {
        "id": "archeology-hard-1",
        "query": "What is the average Potassium in ppm from the first and last time the study recorded people in the Maltese area? Assume that Potassium is linearly interpolated between samples. Round your answer to 4 decimal places.",
        "answer": 8702.5629,
        "answer_type": "exact",
        "runtime": 15,
        "data_sources": [
            "climateMeasurements.xlsx",
            "radiocarbon_database_regional.xlsx"
        ],
        "subtasks": [
            {
                "id": "archeology-hard-1-1",
                "query": "What is the average year of the climate samples in normal years? Round your answer to 4 decimal places.",
                "answer": -1415959.0182,
                "answer_type": "numeric_exact"
            }
        ],
        "key_functionalities": [
            {
                "id": "archeology-hard-1-1",
                "step": "Load the radiocarbon_database_regional.xlsx and climateMeasurements.xlsx and read the first worksheet of each.",
                "query": "Which files contain information about Potassium in ppm and the maltese people?",
                "answer": ["radiocarbon_database_regional.xlsx", "climateMeasurements.xlsx"],
                "answer_type": "list_exact",
                "data_sources": "./"
            },
            {
                "id": "archeology-hard-1-2",
                "step": "Remove rows or columns that are entirely NaN or do not contain relevant information from both dataframes to ensure clean numeric processing.",
                "query": "What are the indices (0-indexed) in rows in the climate measurement dataframe that must be cleaned?",
                "answer": [0, 1, 2, 3, 4],
                "answer_type": "list_exact",
                "data_sources": "climateMeasurements.xlsx"
            },
            {
                "id": "archeology-hard-1-3",
                "step": "Convert both chronologies to calendar years: for the radio-carbon table get the year as 1950 minus the 'date'",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-4",
                "step": "Convert both chronologies to calendar years: for the climate table get the year as 1950 minus the rounded 'Age_ky.1' (in thousands of years) multiplied by 1000.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-5",
                "step": "Determine the span of human presence in the Maltese area by taking the minimum and maximum 'year' in the radio-carbon dataframe.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-6",
                "step": "For every integer year within the human presence span, locate the closest earlier and later rows in the climate dataframe and linearly interpolates (or directly returns) the Potassium value 'K' and collect all these values.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-1-7",
                "step": "Compute the mean of the collected Potassium values.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-hard-2",
        "query": "Based on the approximate dating of the samples found in the Maltese area, what was the percent of time the wet-dry index was increasing? In percentage, round your answer to 2 decimal places.",
        "answer": 16.51,
        "answer_type": "numeric_exact",
        "runtime": 6,
        "data_sources": [
            "climateMeasurements.xlsx",
            "radiocarbon_database_regional.xlsx"
        ],
        "subtasks": [],
        "key_functionalities": [
            {
                "id": "archeology-hard-2-1",
                "step": "Load the first sheet of radiocarbon_database_regional.xlsx and climateMeasurements.xlsx.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-2",
                "step": "Drop any rows or columns that are entirely NaN.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-3",
                "step": "Get the calendar year: for the archaeological samples, year = 1950 \u2212 date",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-4",
                "step": "Get the calendar year for each table: for the climate data, year = 1950 \u2212 (Age_ky.1 rounded to kyrs \u00d7 1000).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-5",
                "step": "Pull the 'ODP 967 wet-dry index' from the nearest earlier and later climate-data bracketing rows and mark the sample as increasing (1) if the later value minus earlier value is positive, otherwise 0.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-2-6",
                "step": "Calculate the percentage of time the wet-dry index was increasing using individual sample data.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-easy-3",
        "query": "What is the average rank of cities in Greece? Assume that if there is an \u201cor\u201d, the average of the two numbers. Round your answer to 4 decimal places.",
        "answer": 3.1333,
        "answer_type": "numeric_exact",
        "runtime": 5,
        "data_sources": [
            "roman_cities.csv"
        ],
        "subtasks": [],
        "key_functionalities": [
            {
                "id": "archeology-easy-3-1",
                "step": "Load roman_cities.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-3-2",
                "step": "Filter rows where the Country column equals 'Greece'.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-3-3",
                "step": "Convert the 'Barrington Atlas Rank' column to numeric values: if the entry contains 'or', split on 'or', convert both parts to integers and take their average; otherwise convert the entry directly to an integer.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-3-4",
                "step": "Compute the mean of the converted numeric ranks of the filtered Greece rows.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-easy-4",
        "query": "What is the amount of calcium in ppm when the dust proxy was the smallest, breaking ties by the minimum wet-dry index? Round your answer to 4 decimal places.",
        "answer": 207878.8774,
        "answer_type": "numeric_exact",
        "runtime": 1,
        "data_sources": [
            "climateMeasurements.xlsx"
        ],
        "subtasks": [],
        "key_functionalities": [
            {
                "id": "archeology-easy-4-1",
                "step": "Load the Excel file `climateMeasurements.xlsx`, reading the first sheet while skipping the first 5 metadata rows so only data rows are retained.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-2",
                "step": "Remove any columns that are completely empty (all\u2010NaN) to keep only informative variables.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-3",
                "step": "Convert both chronologies to calendar years: for the radio-carbon table get the year as 1950 minus the 'date'",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-4",
                "step": "Convert both chronologies to calendar years: for the climate table get the year as 1950 minus the rounded 'Age_ky.1' (in thousands of years) multiplied by 1000.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-5",
                "step": "Find the smallest value in the column `ODP 967 Dust proxy` and filter the dataframe to the rows that have exactly this minimum dust proxy value.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-6",
                "step": "If multiple rows share the same minimum dust proxy, break the tie by selecting the row with the smallest `ODP 967 wet-dry index` among them.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-7",
                "step": "Extract the value in the `Ca` (calcium) column, which gives the calcium concentration (ppm) at the time of minimum dust proxy.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-4-8",
                "step": "Output the calcium value for the resolved single row.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-hard-5",
        "query": "In the Maltese dataset, find the year of the most northern Neolithic sample, breaking ties by considering the later year. What is the maximum aluminum value recorded in the climate dataset in the closest year to that year? If there are multiple closest years, take the max aluminum value measured across all of them. Round your answer to 4 decimal places.",
        "answer": 66158.3691,
        "answer_type": "numeric_exact",
        "runtime": 1,
        "data_sources": [
            "climateMeasurements.xlsx",
            "radiocarbon_database_regional.xlsx"
        ],
        "subtasks": [
            {
                "id": "archeology-hard-5-1",
                "query": "How many samples are human samples?",
                "answer": 97,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-5-2",
                "query": "How many human samples are Neolithic samples?",
                "answer": 70,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-5-3",
                "query": "What is the latitude of the most northern Neolithic sample?",
                "answer": 17.94668,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-5-4",
                "query": "What is the year of the most northern Neolithic sample?",
                "answer": -4460,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-5-5",
                "query": "How many samples are there in the climate dataset in the closest year to the most northern Neolithic sample?",
                "answer": 13,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-5-6",
                "query": "What is the maximum aluminum value recorded in the climate dataset in the closest year to the most northern Neolithic sample?",
                "answer": 66158.3691,
                "answer_type": "numeric_exact"
            }
        ],
        "key_functionalities": [
            {
                "id": "archeology-hard-5-1",
                "step": "Load archeology/input/climateMeasurements.xlsx, archeology/input/radiocarbon_database_regional.xlsx and read the first sheet of each into data frames.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-2",
                "step": "Filter the radiocarbon table to Homo-sapiens records",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-3",
                "step": "Compute 'year' as 1950 \u2212 date.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-4",
                "step": "Filter for Neolithic culture rows",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-5",
                "step": "Filter for row(s) whose Latitude equals the maximum Latitude. If several samples share that same northern latitude, keep only the one(s) with the greatest (latest) 'year'.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-6",
                "step": "Clean the climate table by dropping rows that are entirely NaN and columns that are entirely NaN.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-7",
                "step": "Compute year for the climate table: 1950 \u2212 (Age_ky.1 rounded to 0) \u00d7 1000.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-8",
                "step": "Find the year in the climate table closest to the chosen Neolithic year (smallest absolute difference).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-5-9",
                "step": "Subset the climate table to all rows that have the year closest to the chosen Neolithic year and take the maximum value of the 'Al' (aluminum) column across those rows.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-easy-6",
        "query": "What city contained in both the southern and western hemispheres has the highest population?",
        "answer": "S\u00e3o Paulo",
        "answer_type": "string_exact",
        "runtime": 0.1,
        "data_sources": [
            "worldcities.csv"
        ],
        "subtasks": [],
        "key_functionalities": [
            {
                "id": "archeology-easy-6-1",
                "step": "Load the worldcities.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-6-2",
                "step": "Filter the rows where longitude (lng) is negative to keep cities in the Western Hemisphere.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-6-3",
                "step": "Filter those rows where latitude (lat) is negative to keep only cities that are simultaneously in the Southern Hemisphere.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-6-4",
                "step": "Find the maximum value in the population column passing the longitude and latitude filters.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-6-5",
                "step": "Select the row(s) whose population equals that maximum value (i.e., the most populous city in both hemispheres) and get the corresponding city name.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-hard-7",
        "query": "How many modern cities with a population of over 100k are within 0.1 degrees of ancient Roman-era cities?",
        "answer": 274,
        "answer_type": "numeric_exact",
        "runtime": 0.1,
        "data_sources": [
            "roman_cities.csv",
            "worldcities.csv"
        ],
        "subtasks": [
            {
                "id": "archeology-hard-7-1",
                "query": "How many modern cities have a population of over 100k",
                "answer": 5873,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-7-2",
                "query": "How many of those modern cities with a population of over 100k are within 0.01 degrees of a Roman-era city?",
                "answer": 274,
                "answer_type": "numeric_exact"
            }
        ],
        "key_functionalities": [
            {
                "id": "archeology-hard-7-1",
                "step": "Load roman_cities.csv and worldcities.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-7-2",
                "step": "Extract longitude/latitude columns to build coordinates for both datasets.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-7-3",
                "step": "Filter the modern cities dataframe to keep only rows where population > 100,000.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-7-4",
                "step": "For every modern city coordinate, query the Roman cities coordinates within a 0.1-degree radius (query_ball_point with r = 0.1). Collect modern cities that have at least one Roman city within that radius.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-7-5",
                "step": "Subset the modern cities dataframe to these indices and count the resulting rows to obtain the final answer.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-easy-8",
        "query": "How many unique sources were used in the Roman cities dataset?",
        "answer": 88,
        "answer_type": "numeric_exact",
        "runtime": 0.1,
        "data_sources": [
            "roman_cities.csv"
        ],
        "subtasks": [],
        "key_functionalities": [
            {
                "id": "archeology-easy-8-1",
                "step": "Read the roman_cities.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-8-2",
                "step": "Filter out rows where the 'Select Bibliography' field is null to keep only cities that list at least one source.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-8-3",
                "step": "Iterate over the remaining 'Select Bibliography' entries, normalize/remove period characters and split each entry on semicolons to isolate individual source strings.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-8-4",
                "step": "Take the unique set of the source strings",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-8-5",
                "step": "Find the size of the unique set.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-hard-9",
        "query": "What is the correlation (to 6 decimal places) between the rank of ancient Roman cities and the population of their corresponding modern cities with a population of over one million? For rank, assume that if there is an \u201cor\u201d, the average of the two numbers. Assume that an ancient city is the same as a current city if the distance between the two is less than 0.1 degrees. If there are multiple ancient cities, take the last sample in the data. Round your answer to 6 decimal places.",
        "answer": 0.015648,
        "answer_type": "numeric_exact",
        "runtime": 0.1,
        "data_sources": [
            "roman_cities.csv",
            "worldcities.csv"
        ],
        "subtasks": [
            {
                "id": "archeology-hard-9-1",
                "query": "How many modern cities with a population of over one million exist?",
                "answer": 767,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-9-2",
                "query": "Clean the Roman city rank data. What is the average rank after cleaning?",
                "answer": 3.216,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-9-3",
                "query": "How many of our selected modern cities correspond to some Roman city?",
                "answer": 30,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-9-4",
                "query": "Calculate the r-score between the Roman city rank and the modern city population.",
                "answer": 0.015648,
                "answer_type": "numeric_exact"
            }
        ],
        "key_functionalities": [
            {
                "id": "archeology-hard-9-1",
                "step": "Read roman_cities.csv and worldcities.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-2",
                "step": "Filter for modern cities whose population column is greater than 1,000,000.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-3",
                "step": "Convert the 'Barrington Atlas Rank' string of each Roman city into a numeric value: extract all numbers (handles 'or' cases), take their average; handle missing valuea.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-4",
                "step": "Build two coordinate arrays: Roman cities' (Longitude, Latitude) and modern cities' (lng, lat).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-5",
                "step": "For every modern city, find all Roman cities lying within 0.1 degrees by coordinate.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-6",
                "step": "When matches exist, link that modern city with the Roman city that has the highest (max) numeric rank among the matches.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-7",
                "step": "Gather data vectors of the populations of the selected modern cities and ranks of their matched Roman cities.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-9-8",
                "step": "Compute the Pearson correlation between the two demographics data vectors.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-easy-10",
        "query": "Which country has the highest average population in its cities?",
        "answer": "Singapore",
        "answer_type": "string_exact",
        "runtime": 0.1,
        "data_sources": [
            "worldcities.csv"
        ],
        "subtasks": [],
        "key_functionalities": [
            {
                "id": "archeology-easy-10-1",
                "step": "Read the worldcities.csv.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-10-2",
                "step": "Group the rows by the 'country' column and compute the mean of the 'population' column for each country.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-10-3",
                "step": "Identify the country whose mean population value is the largest (using idxmax).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-10-4",
                "step": "Print that country name as the answer.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-easy-11",
        "query": "What is the average latitude of capital cities? If there're more than one capital in a country, only count the lat of the capital with the largest population. Round your answer to 4 decimal places.",
        "answer": 17.4274,
        "answer_type": "numeric_exact",
        "runtime": 0.1,
        "data_sources": [
            "worldcities.csv"
        ],
        "subtasks": [
            {
                "id": "archeology-easy-11-1",
                "query": "Extract all of the capital cities. How many exist?",
                "answer": 237,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-easy-11-1",
                "query": "Compute the average latitude of all of the capitals. Round your answer to 4 decimal places.",
                "answer": 17.4274,
                "answer_type": "numeric_exact"
            }
        ],
        "key_functionalities": [
            {
                "id": "archeology-easy-11-1",
                "step": "Read worldcities.csv .",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-2",
                "step": "Filter rows where the 'capital' column equals 'primary' to keep only capital-city records.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-3",
                "step": "Identify all unique countries represented in this filtered set.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-4",
                "step": "For each country, if it has multiple capital records, select the capital with the largest 'population' value; otherwise keep the single record.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-5",
                "step": "Collect the latitude ('lat') of the chosen capital for every country.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-easy-11-6",
                "step": "Compute the mean of these latitude values and round the result to four decimal places.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    },
    {
        "id": "archeology-hard-12",
        "query": "Count the number of human conflicts between 800 and 1400 AD, and attribute them as best you can to modern countries. Define a conflict as between two actors that lasts at least a year.",
        "answer": 422,
        "answer_type": "numeric_exact",
        "runtime": 0.1,
        "data_sources": [
            "conflict.csv",
            "worldcities.csv"
        ],
        "subtasks": [
            {
                "id": "archeology-hard-12-1",
                "query": "Get the set of countries from our dataset. How many countries are there?",
                "answer": 241,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-12-2",
                "query": "Clean the conflict dataset as best you can, extracting the two sides, and the start and end year. How many conflicts are there in the cleaned dataset?",
                "answer": 480,
                "answer_type": "numeric_exact"
            },
            {
                "id": "archeology-hard-12-3",
                "query": "Process the conflicts, removing any duplicate conflicts according to the definition in the original question.",
                "answer": 422,
                "answer_type": "numeric_exact"
            }
        ],
        "key_functionalities": [
            {
                "id": "archeology-hard-12-1",
                "step": "Read worldcities.csv to build a set of modern country names that will be used to detect actors' home countries.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-2",
                "step": "Load conflict_brecke.csv",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-3",
                "step": "For each conflict, get the two actors by splitting the 'Conflict' text on \u201c-\u201d or \u201cand\u201d (otherwise treat it as a single-party conflict).",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-4",
                "step": "Extract start and end years for the conflicts.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-5",
                "step": "Search each actor string for any substring that matches a country name from the world-cities list (case-insensitive); keep the first match or drop the conflict if either actor cannot be matched to a country.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-6",
                "step": "Detect overlaps using data with clean records for actor-A, actor-B, start year, end year by comparing whether an end year proceeds a start year.a",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            },
            {
                "id": "archeology-hard-12-7",
                "step": "Count the remaining non-overlapping conflict rows and print that count as the final answer.",
                "query": "",
                "answer": "",
                "answer_type": "",
                "data_sources": ""
            }
        ]
    }
]